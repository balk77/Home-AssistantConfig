- id: wk_muur2
  alias: 'WK Muur: aan op Beweging'
  trigger:
  - entity_id: binary_sensor.wk_multisensor_burglar
    platform: state
    to: 'on'
  condition:
  - condition: and
    conditions:
    - condition: template
      value_template: '{{ states.sun.sun.attributes.elevation  | int < 8 }}'
    - condition: state
      entity_id: input_boolean.huis_slaapstand
      state: 'off'
  action:
  - data:
      brightness: 125
      entity_id: light.wk_muur_level
      transition: 10
    service: light.turn_on
  mode: single
- id: wk_muur3
  alias: 'WK Muur: na zonsopgang uit'
  trigger:
  - above: '8'
    entity_id: sun.sun
    platform: numeric_state
    value_template: '{{ state.attributes.elevation }}'
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: group.woonkamer_ex_muur
      state: 'off'
    - before: '12:00:00'
      condition: time
  action:
  - data:
      entity_id: light.wk_muur_level
    service: light.turn_off
  - service: light.turn_off
    data: {}
    entity_id: light.lichtsnoer
  mode: single
- id: wk_muur4
  alias: 'WK Muur: uit bij geen Beweging'
  trigger:
  - entity_id: binary_sensor.wk_multisensor_burglar
    for: 0:10:00
    platform: state
    to: 'off'
  condition:
  - condition: and
    conditions:
    - condition: template
      value_template: '{{ states.sun.sun.attributes.elevation  | int > 8 }}'
    - condition: state
      entity_id: input_boolean.huis_slaapstand
      state: 'off'
  action:
  - data:
      entity_id: light.wk_muur_level
    service: light.turn_off
- id: toggle_bankje
  alias: 'WK muur: Toggle aan/uit'
  trigger:
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      node_id: 9
      value: 26
  action:
  - data:
      brightness: 125
      entity_id: light.wk_muur_level
      transition: 3
    service: light.toggle
  mode: single
- id: douche_counter
  alias: 'Douche counter: count +1'
  trigger:
  - entity_id: input_boolean.shower2
    for: 0:02:00
    platform: state
    to: 'on'
  action:
  - data:
      entity_id: counter.douches
    service: counter.increment
  mode: single
- id: reset_douche_counter
  alias: 'Douche Counter: Reset'
  trigger:
  - at: '1:00:00'
    platform: time
  action:
  - data:
      entity_id: counter.douches
    service: counter.reset
- id: hank_wk1
  alias: Hank wk1
  trigger:
    platform: event
    event_type: zwave.scene_activated
    event_data:
      entity_id: zwave.hank_knop_wk
      scene_id: 1
  action:
  - service: light.turn_on
    data_template:
      entity_id: light.wk_eettafel_plafond_level
      brightness: '{% if is_state(''light.wk_eettafel_plafond_level'', ''off'') %}
        50 {% else %}  {% set suggested = states.light.wk_eettafel_plafond_level.attributes.brightness|int
        + 50 %} {% if suggested < 254 %} {{ suggested }} {% else %} 0 {% endif %}
        {% endif %}

        '
  - service: light.turn_on
    data_template:
      entity_id: light.wk_eettafel_plafond_level
      brightness: '{% if is_state(''light.wk_eettafel_plafond_level'', ''off'') %}
        50 {% else %}  {% set suggested = states.light.wk_eettafel_plafond_level.attributes.brightness|int
        + 50 %} {% if suggested < 254 %} {{ suggested }} {% else %} 0 {% endif %}
        {% endif %}

        '
- id: irremoteprevious
  alias: IR Remote Previous
  trigger:
  - device_id: 1e1abf6192354ed4a54b11c3f8ea4679
    domain: binary_sensor
    entity_id: binary_sensor.ir_remote_previous
    platform: device
    type: turned_on
  action:
  - data:
      entity_id: media_player.spotify_void
    service: media_player.media_previous_track
- id: irremotenext
  alias: IR Remote Next
  trigger:
  - device_id: 1e1abf6192354ed4a54b11c3f8ea4679
    domain: binary_sensor
    entity_id: binary_sensor.ir_remote_next
    platform: device
    type: turned_on
  action:
  - data:
      entity_id: media_player.spotify_void
    service: media_player.media_next_track
- id: irremoteplaypause
  alias: IR Remote Play/Pause
  trigger:
  - device_id: 1e1abf6192354ed4a54b11c3f8ea4679
    domain: binary_sensor
    entity_id: binary_sensor.ir_remote_playpause
    platform: device
    type: turned_on
  action:
  - data:
      entity_id: media_player.spotify_void
    service: media_player.media_play_pause
- id: irremotevoldown
  alias: IR Remote Volume Down
  trigger:
  - device_id: 1e1abf6192354ed4a54b11c3f8ea4679
    domain: binary_sensor
    entity_id: binary_sensor.ir_remote_voldown
    platform: device
    type: turned_on
  action:
  - data:
      entity_id: media_player.spotify_void
    service: media_player.volume_down
- id: irremotevolup
  alias: IR Remote Volume Up
  trigger:
  - device_id: 1e1abf6192354ed4a54b11c3f8ea4679
    domain: binary_sensor
    entity_id: binary_sensor.ir_remote_volup
    platform: device
    type: turned_on
  action:
  - data:
      entity_id: media_player.spotify_void
    service: media_player.volume_up
- id: Keuken_aanrecht_muur_1
  alias: Keuken aanrecht knop bediening
  trigger:
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      node_id: 12
      value: 26
  action:
  - service: light.toggle
    data:
      entity_id: light.keuken_aanrecht_groep
  mode: single
- id: Keuken_aanrecht_muur_2
  alias: Keuken aanrecht knop aan max
  trigger:
  - entity_id: light.keuken_aanrecht_groep
    from: 'off'
    platform: state
    to: 'on'
  action:
  - data:
      brightness: 255
      entity_id: light.keuken_aanrecht_groep
    service: light.turn_on
- id: Keuken_aanrecht_muur_3
  alias: Keuken aanrecht dim om 20:00
  trigger:
    platform: time
    at: '20:00:00'
  condition:
  - condition: state
    entity_id: light.keuken_aanrecht_groep
    state: 'on'
  - condition: state
    entity_id: input_boolean.pir_sensor_keuken_2oo2
    state: 'off'
  action:
  - service: light.turn_on
    data:
      entity_id: light.keuken_aanrecht_groep
      brightness: 150
      transition: 30
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.pir_sensor_keuken
- id: keuken_aanrecht_pir_vol
  alias: Keuken aanrecht vol bij Beweging
  trigger:
    platform: state
    entity_id: input_boolean.pir_sensor_keuken_2oo2
    to: 'on'
  condition:
    condition: state
    entity_id: light.keuken_aanrecht_groep
    state: 'on'
  action:
  - service: light.turn_on
    data:
      entity_id: light.keuken_aanrecht_groep
      brightness: 255
      transition: 1
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.pir_sensor_keuken
- id: keuken_aanrecht_pir_dim
  alias: Keuken aanrecht dim bij geen Beweging
  trigger:
    platform: state
    entity_id: input_boolean.pir_sensor_keuken_2oo2
    to: 'off'
    for:
      seconds: '240'
  condition:
  - condition: state
    entity_id: light.keuken_aanrecht_groep
    state: 'on'
  - condition: time
    after: '20:00:00'
  - condition: state
    entity_id: input_boolean.huis_slaapstand
    state: 'off'
  action:
  - service: light.turn_on
    data:
      entity_id: light.keuken_aanrecht_groep
      brightness: 150
      transition: 30
- id: keuken_aanrecht_reboot
  alias: Keuken aanrecht sensor reboot
  trigger:
  - platform: mqtt
    topic: keuken_aanrecht_rechts/boot
    payload: reboot
  - platform: mqtt
    topic: keuken_aanrecht_links/boot
    payload: reboot
  action:
    service: notify.telegram
    data:
      message: Keuken sensor reboot!
- id: keuken_aanrecht_geen_beweging
  alias: Keuken aanrecht geen Beweging
  trigger:
    platform: state
    entity_id: input_boolean.pir_sensor_keuken_2oo2
    to: 'off'
    for:
      seconds: '240'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.pir_sensor_keuken
- id: keuken_aanrecht_aan_ochtend
  alias: Keuken aanrecht aan in ochtend
  trigger:
  - entity_id: input_boolean.pir_sensor_keuken_2oo2
    platform: state
    to: 'on'
  condition:
  - after: '5:30:00'
    before: '6:45:00'
    condition: time
  - condition: template
    value_template: '{{as_timestamp(now()) - as_timestamp(states.light.keuken_aanrecht_groep.last_changed)
      > 30 }}'
  - before: sunrise
    condition: sun
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - data:
      brightness: 255
      entity_id: light.keuken_aanrecht_groep
    service: light.turn_on
  - data:
      entity_id: input_boolean.pir_sensor_keuken
    service: input_boolean.turn_on
  mode: single
- id: keuken_aanrecht_uit_ochtend
  alias: Keuken aanrecht uit in ochtend
  trigger:
    platform: state
    entity_id: input_boolean.pir_sensor_keuken
    to: 'off'
  condition:
  - condition: time
    after: '5:45:00'
    before: '6:50:00'
  action:
  - service: light.turn_off
    data:
      entity_id: light.keuken_aanrecht_groep
- id: itho_1
  alias: Restart ITHO on false status
  trigger:
  - entity_id: sensor.itho_ventilatie_status
    for:
      seconds: 20
    platform: state
    to: 'false'
  action:
  - data:
      payload: restart
      topic: hass/itho/cmd
    service: mqtt.publish
  - delay: 00:01:00
  - data:
      payload: State,1
      topic: hass/itho/cmd
    service: mqtt.publish
- id: updater
  alias: 'Updater: Update Available Notification'
  trigger:
  - entity_id: binary_sensor.updater
    platform: state
    to: 'on'
  action:
  - data:
      message: Home Assistant {{ state_attr('binary_sensor.updater', 'newest_version')
        }} is available.
    service: notify.telegram
- id: appdaemon_alive_1
  alias: 'VOID appdaemon: off for 5 minutes'
  description: Checks if appdaemon status is off for > 5 minutes
  trigger:
  - entity_id: input_boolean.appdaemon_alive
    for: 0:05:00
    platform: state
    to: 'off'
  action:
  - data:
      message: Appdaemon draait niet
    service: notify.telegram
  mode: single
- id: appdaemon_alive_2
  alias: 'VOID appdaemon: switch off boolean every 5 minutes'
  description: Switch off "appdaemon alive" boolean every 5 minutes
  trigger:
  - minutes: /5
    platform: time_pattern
  action:
  - data:
      entity_id: input_boolean.appdaemon_alive
    service: input_boolean.turn_off
  mode: single
- id: '1597000596741'
  alias: 'appdaemon: check if online'
  description: ''
  trigger:
  - minutes: /5
    platform: time_pattern
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: counter.appdaemon_disconnected
        state: '2'
      sequence:
      - service: notify.telegram
        data:
          message: Appdaemon restart
      - service: counter.reset
        data: {}
        entity_id: counter.appdaemon_disconnected
      - service: rest_command.appdaemon_restart
        data: {}
    - conditions:
      - condition: state
        entity_id: input_boolean.appdaemon_alive
        for: 0:01:00
        state: 'off'
      sequence:
      - data:
          message: Appdaemon draait niet
        service: notify.telegram
      - service: counter.increment
        data: {}
        entity_id: counter.appdaemon_disconnected
    default:
    - data:
        entity_id: input_boolean.appdaemon_alive
      service: input_boolean.turn_off
    - service: counter.reset
      data: {}
      entity_id: counter.appdaemon_disconnected
  mode: single
- id: pingpong
  alias: Telegram bot that reply pong to ping
  trigger:
    platform: event
    event_type: telegram_command
    event_data:
      command: /ping
  action:
  - service: notify.telegram
    data:
      message: 'pong

        pang'
- id: sander_gaat_weg
  alias: Sander gaat weg
  trigger:
  - entity_id: device_tracker.phone_sander
    platform: state
    to: not_home
  action:
  - data:
      message: Sander verlaat het huis
    service: notify.telegram
- id: restart_ems-esp
  alias: restart EMS ESP device
  trigger:
    platform: time
    at: 03:00:00
  action:
  - service: mqtt.publish
    data:
      payload: 1
      topic: home/ems-esp/restart
- id: rolluik_manual
  alias: 'Zonnescherm: Manual operation'
  description: Override automatische bediening rolluik
  trigger:
  - entity_id: sensor.rolluik_handbediening
    platform: state
    to: '16'
  - entity_id: sensor.rolluik_handbediening
    platform: state
    to: '26'
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      node_id: 24
      value: 16
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      node_id: 24
      value: 26
  action:
  - data: {}
    entity_id: input_boolean.zonnescherm_manual
    service: input_boolean.turn_on
  mode: single
- id: rolluik_reset
  alias: 'Zonnescherm: reset'
  description: Reset override automatische bediening rolluik
  trigger:
  - at: '22:00:00'
    platform: time
  action:
  - entity_id: input_boolean.zonnescherm_manual
    service: input_boolean.turn_off
- id: sous_vide_on
  alias: Start Sous Vide unit
  trigger:
  - platform: state
    entity_id: input_boolean.sousvide_active
    to: 'on'
  action:
  - data:
      payload: running
      topic: anova/command/run
    service: mqtt.publish
- id: sous_vide_off
  alias: Stop Sous Vide unit
  trigger:
  - platform: state
    entity_id: input_boolean.sousvide_active
    to: 'off'
  action:
  - data:
      payload: stopped
      topic: anova/command/run
    service: mqtt.publish
- id: wasmachine_01
  alias: 'Wasmachine/droger: Washer Start'
  trigger:
  - entity_id: input_boolean.washer_pwrup
    for: 0:03:00
    from: 'off'
    platform: state
    to: 'on'
  action:
  - data:
      entity_id: input_boolean.washer_switch
    service: input_boolean.turn_on
- id: wasmachine_02
  alias: 'Wasmachine/droger: Wasmachine Klaar'
  trigger:
  - entity_id: input_boolean.washer_pwrup
    for: 0:03:00
    from: 'on'
    platform: state
    to: 'off'
  condition:
  - condition: state
    entity_id: input_boolean.washer_switch
    state: 'on'
  action:
  - data:
      message: Wasmachine is klaar!
    service: notify.telegram
  - data:
      entity_id: input_boolean.washer_switch
    service: input_boolean.turn_off
- id: droger_01
  alias: 'Wasmachine/droger: Dryer Start'
  trigger:
  - entity_id: input_boolean.dryer_pwrup
    for: 0:03:00
    from: 'off'
    platform: state
    to: 'on'
  action:
  - data:
      entity_id: input_boolean.dryer_switch
    service: input_boolean.turn_on
- id: droger_02
  alias: 'Wasmachine/droger: Droger Klaar'
  trigger:
  - entity_id: input_boolean.dryer_pwrup
    for: 0:03:00
    from: 'on'
    platform: state
    to: 'off'
  condition:
  - condition: state
    entity_id: input_boolean.dryer_switch
    state: 'on'
  action:
  - data:
      message: Droger is klaar!
    service: notify.telegram
  - data:
      entity_id: input_boolean.dryer_switch
    service: input_boolean.turn_off
- id: wasmachine_05
  alias: 'Wasmachine/droger: notify if wasmachine meting is uit'
  trigger:
  - entity_id: binary_sensor.powermeterwmdrstatus
    for: 00:02
    platform: state
    to: 'off'
  action:
  - data:
      message: Wasmachine meting staat uit!
    service: notify.telegram
- id: thermostaat_3
  alias: 'Slaapstand: Aan om 2:00'
  trigger:
  - at: '2:00:00'
    platform: time
  condition:
  - condition: state
    entity_id: input_boolean.huis_slaapstand
    state: 'off'
  action:
  - data:
      entity_id: input_boolean.huis_slaapstand
    service: input_boolean.turn_on
- id: occupancy_sim_on
  alias: Simulate Occupancy - on
  trigger:
  - entity_id: input_boolean.occupancy_simulation
    platform: state
    to: 'on'
  action:
  - data: {}
    entity_id: scene.woonkamer_low
    service: scene.turn_on
  - data:
      message: 'Occusim: lichten gaan aan'
    service: notify.telegram
  mode: single
- id: occupancy_sim_off
  alias: 'Occusim: set trigger to off (PIR)'
  trigger:
  - entity_id: binary_sensor.wk_multisensor_burglar
    platform: state
    to: 'on'
  - entity_id: input_boolean.pir_sensor_keuken_2oo2
    platform: state
    to: 'on'
  action:
  - entity_id: input_boolean.occupancy_simulation
    service: input_boolean.turn_off
  mode: single
- id: occupancy_sim_goodnight
  alias: 'Occu_not_sim: occupancy_sim_goodnight'
  trigger:
  - at: '22:30'
    platform: time
  condition:
  - condition: state
    entity_id: input_boolean.occupancy_simulation
    state: 'on'
  action:
  - data:
      entity_id: input_boolean.occupancy_simulation
    service: input_boolean.turn_off
  - data:
      entity_id: group.woonkamer
    service: light.turn_off
  - data:
      entity_id: group.woonkamer
    service: switch.turn_off
  - data:
      message: Lampen in huis gaan uit
    service: notify.telegram
- id: reset_huis_slaapstand
  alias: 'Slaapstand: Reset'
  trigger:
  - at: 04:00:00
    platform: time
  action:
  - data:
      entity_id: input_boolean.huis_slaapstand
    service: input_boolean.turn_off
- id: set_huis_slaapstand
  alias: 'Slaapstand: activeer'
  trigger:
  - entity_id: group.woonkamer
    platform: state
    to: 'off'
  condition:
  - condition: or
    conditions:
    - after: '21:00:00'
      condition: time
    - before: '4:00:00'
      condition: time
  action:
  - data:
      entity_id: input_boolean.huis_slaapstand
    service: input_boolean.turn_on
- id: notify_when_not_home_1
  alias: 'Occu_not_sim: Notify and activate Occupancy Simulation 1'
  trigger:
  - at: '18:10:00'
    platform: time
  condition:
  - condition: and
    conditions:
    - after: sunset
      condition: sun
    - condition: state
      entity_id: group.woonkamer
      state: 'off'
  action:
  - data:
      message: Lampen in huis gaan aan - aanwezigheidssimulatie
    service: notify.telegram
  - data:
      entity_id: input_boolean.occupancy_simulation
    service: input_boolean.turn_on
- id: notify_when_not_home_2
  alias: 'Occu_not_sim: Start Notify and activate Occupancy Simulation'
  trigger:
  - event: sunset
    platform: sun
  condition:
  - condition: and
    conditions:
    - after: '18:10:00'
      condition: time
    - condition: state
      entity_id: group.woonkamer
      state: 'off'
    - before: '22:30:00'
      condition: time
  action:
  - data:
      message: Lampen in huis gaan aan - aanwezigheidssimulatie
    service: notify.telegram
  - data:
      entity_id: input_boolean.occupancy_simulation
    service: input_boolean.turn_on
- id: vals_woonkamer_on
  alias: Detect vals aantal lampen aan in woonkamer
  trigger:
  - entity_id: binary_sensor.wk_multisensor_burglar
    for: 0:60:00
    platform: state
    to: 'on'
  condition:
  - condition: and
    conditions:
    - after: '22:00:00'
      condition: time
    - condition: template
      value_template: '{{ states.sensor.woonkamer_number_of_lights_on.state | int
        <= 2  }}'
    - condition: state
      entity_id: media_player.chromecast6826
      state: Unavailable
  action:
  - data:
      entity_id: script.woonkamer_off
    service: script.turn_on
  - data:
      entity_id: input_boolean.huis_slaapstand
    service: input_boolean.turn_on
- id: disable_cv_ketel
  alias: 'Vakantiemodus: aan'
  trigger:
  - entity_id: sensor.lichtknop_wk_links_boven
    platform: state
    to: '14'
  action:
  - data:
      entity_id: input_boolean.vakantie
    service: input_boolean.turn_on
- id: enable_cv_ketel
  alias: 'Vakantiemodus: uit'
  trigger:
  - entity_id: person.sander
    platform: state
    to: home
  - entity_id: person.linda
    platform: state
    to: home
  - entity_id: light.keuken_aanrecht_groep
    from: 'off'
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.vakantie
    state: 'on'
  action:
  - data:
      entity_id: input_boolean.vakantie
    service: input_boolean.turn_off
- id: wk_multisensor_battery1
  alias: 'Multisensor Woonkamer: battery turns low'
  trigger:
  - below: '25'
    entity_id: sensor.woonkamer_multisensor_battery_level_2
    platform: numeric_state
  action:
  - data:
      message: wkmultisensor batterij niveau is {{ states('sensor.woonkamer_multisensor_battery_level_2')
        }}
    service: notify.telegram
  mode: single
- id: wk_multisensor_battery2
  alias: 'Multisensor Woonkamer: reminder battery low'
  trigger:
  - at: '19:00:00'
    platform: time
  condition:
  - below: '26'
    condition: numeric_state
    entity_id: sensor.woonkamer_multisensor_battery_level_2
  action:
  - data:
      message: wkmultisensor batterij niveau is {{ states('sensor.woonkamer_multisensor_battery_level_2')
        }}
    service: notify.telegram
  mode: single
- id: zolder_multisensor_battery1
  alias: 'Multisensor Zolder: battery turns low'
  trigger:
  - below: '25'
    entity_id: sensor.zolder_multisensor_battery_level
    platform: numeric_state
  action:
  - data:
      message: zolder multisensor batterij niveau is {{ states('sensor.zolder_multisensor_battery_level')
        }}
    service: notify.telegram
  mode: single
- id: zolder_multisensor_battery2
  alias: 'Multisensor Zolder: reminder battery low'
  trigger:
  - at: '19:00:00'
    platform: time
  condition:
  - below: '26'
    condition: numeric_state
    entity_id: sensor.zolder_multisensor_battery_level
  action:
  - data:
      message: zolder multisensor batterij niveau is {{ states('sensor.zolder_multisensor_battery_level')
        }}
    service: notify.telegram
  mode: single
- id: beweging_zolder2
  alias: Beweging zolder aan/uit
  trigger:
  - entity_id: binary_sensor.zolder_multisensor_burglar
    platform: state
    to: 'on'
  action:
  - entity_id: input_boolean.zolder_beweging
    service: input_boolean.turn_on
  - delay: 00:15:00
  - entity_id: input_boolean.zolder_beweging
    service: input_boolean.turn_off
  mode: restart
- id: '1577117549221'
  alias: 'Occusim: activate at sunset'
  description: ''
  trigger:
  - event: sunset
    offset: -00:30:00
    platform: sun
  condition:
  - condition: state
    entity_id: light.wk_muur_level
    state: 'off'
  - before: '22:00:00'
    condition: time
  - after: '18:00:00'
    condition: time
  - condition: state
    entity_id: input_boolean.huis_slaapstand
    state: 'off'
  - condition: state
    entity_id: light.keuken_aanrecht_groep
    state: 'off'
  - condition: state
    entity_id: light.wk_eettafel_plafond_level
    state: 'off'
  - condition: state
    entity_id: light.wk_achter_plafond_level
    state: 'off'
  action:
  - delay: 00:{{ (range(10, 20)|random|int) }}:00
  - entity_id: input_boolean.occupancy_simulation
    service: input_boolean.turn_on
  - scene: scene.woonkamer_low
  - data:
      message: Lichten gaan aan
    service: notify.telegram
  mode: single
- id: '1577122755949'
  alias: 'Occusim: Notify on'
  description: ''
  trigger:
  - entity_id: scene.woonkamer_low
    platform: state
  condition:
  - condition: state
    entity_id: input_boolean.vakantie
    state: 'on'
  action:
  - data:
      message: 'Occusim: lichten gaan aan'
    service: notify.telegram
  mode: single
- id: '1577123052505'
  alias: 'Occusim: Notify off'
  description: ''
  trigger:
  - entity_id: script.all_lights_off
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.occupancy_simulation
    state: 'on'
  action:
  - data:
      message: 'Occusim: lichten gaan uit'
    service: notify.telegram
- id: '1578223710807'
  alias: 'Server: high CPU load'
  description: ''
  trigger:
  - above: '2.5'
    entity_id: sensor.load_15m
    for: '"1:00:00"'
    platform: numeric_state
  condition: []
  action:
  - data:
      message: Hoge server load
    service: notify.telegram
- id: '1584773344706'
  alias: 'fan: reset input_boolean.humidity_to_full'
  description: ''
  trigger:
  - entity_id: input_boolean.humidity_to_full
    for: 0:05:00
    from: 'off'
    platform: state
    to: 'on'
  condition: []
  action:
  - data:
      entity_id: input_boolean.humidity_to_full
    service: input_boolean.turn_off
- id: '1584773494573'
  alias: 'fan: reset input_boolean.humidity_to_high'
  description: ''
  trigger:
  - entity_id: input_boolean.humidity_to_high
    for: 0:05:00
    from: 'off'
    platform: state
    to: 'on'
  condition: []
  action:
  - data:
      entity_id: input_boolean.humidity_to_high
    service: input_boolean.turn_off
- id: '1584773561864'
  alias: 'fan: reset input_boolean.humidity_to_medium'
  description: x
  trigger:
  - entity_id: input_boolean.humidity_to_medium
    for: 0:05:00
    from: 'off'
    platform: state
    to: 'on'
  condition: []
  action:
  - data:
      entity_id: input_boolean.humidity_to_medium
    service: input_boolean.turn_off
- id: '1586547913019'
  alias: 'Zonnescherm: open bij zonsondergang'
  description: ''
  trigger:
  - above: '234'
    entity_id: sensor.azimuth
    platform: numeric_state
  condition: []
  action:
  - data:
      position: 99
    entity_id: cover.rolluik
    service: cover.set_cover_position
  - data: {}
    entity_id: input_boolean.zonnescherm_manual
    service: input_boolean.turn_off
  mode: single
- id: '1586548606521'
  alias: 'Zonnescherm: dicht bij zon..'
  description: ''
  trigger:
  - minutes: /5
    platform: time_pattern
  condition:
  - condition: and
    conditions:
    - above: '54'
      below: '234'
      condition: numeric_state
      entity_id: sensor.azimuth
    - below: '0.1'
      condition: numeric_state
      entity_id: sensor.delft_precipitation_forecast_total
    - condition: state
      entity_id: input_boolean.zonnescherm_manual
      state: 'off'
    - condition: numeric_state
      entity_id: sensor.delft_irradiance
      above: '500'
  action:
  - data:
      position: 20
    service: cover.set_cover_position
    target:
      entity_id: cover.rolluik
  mode: single
- id: '1586549028766'
  alias: 'Zonnescherm: open bij regen2 - disabled'
  description: ''
  trigger:
  - minutes: /5
    platform: time_pattern
  condition:
  - condition: state
    entity_id: input_boolean.zonnescherm_manual
    state: 'on'
  - above: '0.1'
    condition: numeric_state
    entity_id: sensor.delft_precipitation_forecast_total
  - below: '550'
    condition: numeric_state
    entity_id: sensor.delft_irradiance
  action:
  - data:
      position: 100
    entity_id: cover.level_mqtt_ozw
    service: cover.set_cover_position
- id: '1586584791746'
  alias: 'Zonnescherm: open bij regen'
  description: ''
  trigger:
  - above: '0.1'
    entity_id: sensor.delft_precipitation_forecast_total
    platform: numeric_state
  condition:
  - condition: and
    conditions:
    - above: '54'
      below: '234'
      condition: numeric_state
      entity_id: sensor.azimuth
  action:
  - data:
      position: 99
    entity_id: cover.rolluik
    service: cover.set_cover_position
  - data: {}
    entity_id: input_boolean.zonnescherm_manual
    service: input_boolean.turn_on
  mode: single
- id: '1586585344614'
  alias: 'Zonnescherm: open bij geen zon'
  description: ''
  trigger:
  - below: '450'
    entity_id: sensor.delft_irradiance
    platform: numeric_state
  condition:
  - condition: state
    entity_id: input_boolean.zonnescherm_manual
    state: 'off'
  action:
  - data:
      position: 99
    entity_id: cover.rolluik
    service: cover.set_cover_position
  mode: single
- id: '1590699496659'
  alias: WK Motion test
  description: ''
  trigger:
  - entity_id: binary_sensor.wk_multisensor_burglar
    platform: state
    to: 'on'
  condition: []
  action:
  - data:
      message: Ping
    service: notify.telegram
- id: '1593544556393'
  alias: Update OpenUV
  description: Update OpenUV every 30 minutes while the sun is at least 15 degrees
    above the horizon
  trigger:
  - minutes: /30
    platform: time_pattern
  condition:
  - above: '15'
    condition: numeric_state
    entity_id: sun.sun
    value_template: '{{ state.attributes.elevation }}'
  action:
  - data: {}
    service: openuv.update_data
- id: '1595625325709'
  alias: 'Occusim: random off'
  description: ''
  trigger:
  - at: '22:20:00'
    platform: time
  condition:
  - condition: state
    entity_id: input_boolean.occupancy_simulation
    state: 'on'
  action:
  - delay:
      hours: 0
      minutes: '{{ range(1, 30)|random }}'
      seconds: 0
      milliseconds: 0
  - service: light.turn_off
    data: {}
    entity_id: all
  - data:
      message: 'Occusim: lichten gaan uit'
    service: notify.telegram
  - data: {}
    entity_id: input_boolean.occupancy_simulation
    service: input_boolean.turn_off
  - delay: 00:00:10
  - service: light.turn_on
    data: {}
    entity_id: light.mbr_plafond_level
  - delay:
      hours: 0
      minutes: 5
      seconds: 0
      milliseconds: 0
  - service: light.turn_off
    data: {}
    entity_id: light.mbr_plafond_level
  mode: single
- id: '1599243609890'
  alias: Keuken aanrecht PIR keuken 2oo2
  description: ''
  trigger:
  - entity_id: binary_sensor.pir_sensor_keuken_links
    platform: state
    to: 'on'
  - entity_id: binary_sensor.pir_sensor_keuken_rechts
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.pir_sensor_keuken_links
    state: 'on'
  - condition: state
    entity_id: binary_sensor.pir_sensor_keuken_rechts
    state: 'on'
  action:
  - data: {}
    entity_id: input_boolean.pir_sensor_keuken_2oo2
    service: input_boolean.turn_on
  - delay: 00:00:10
  - data: {}
    entity_id: input_boolean.pir_sensor_keuken_2oo2
    service: input_boolean.turn_off
  mode: restart
- id: '1600027586224'
  alias: Radiator valve interlock open
  description: ''
  trigger:
  - entity_id: input_boolean.radiator_valve_dide_interlock
    platform: state
    to: 'on'
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.valve_close_dummy2
    service: input_boolean.turn_off
  mode: restart
- id: '1600027698220'
  alias: Radiator valve interlock
  description: ''
  trigger:
  - entity_id: input_select.radiator_valve_dide_interlock
    platform: state
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_select.radiator_valve_dide_interlock
        state: open
      sequence:
      - data: {}
        entity_id: input_boolean.valve_close_dummy2
        service: input_boolean.turn_off
    default: []
  mode: restart
- id: '1600286307526'
  alias: Restart QT Openzwave
  description: ''
  trigger:
  - entity_id: sensor.qtopenzwavestatus
    for: 00:01:00
    platform: state
    to: Offline
  condition: []
  action:
  - data:
      message: QT Openzwave offline
    service: notify.telegram
  - data: {}
    service: rest_command.qt_openzwave_restart
  mode: single
- id: '1602229469049'
  alias: 'Dide thermostaat: set target temp from climate'
  description: ''
  trigger:
  - platform: state
    entity_id: climate.kamer_dide
    attribute: temperature
  condition: []
  action:
  - service: input_number.set_value
    data:
      value: '{{ state_attr("climate.kamer_dide","temperature") }}'
      entity_id: input_number.slaapkamer_dide_setpoint
  mode: single
- id: '1602231387187'
  alias: 'Dide thermostaat: set target temp from input_number'
  description: ''
  trigger:
  - platform: state
    entity_id: input_number.slaapkamer_dide_setpoint
  condition: []
  action:
  - service: climate.set_temperature
    data:
      temperature: '{{ states("input_number.slaapkamer_dide_setpoint") }}'
      entity_id: climate.kamer_dide
  mode: single
- id: '1602617783292'
  alias: 'Dide radiator: reset integraal'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.burner_current_power
    above: '0'
  condition: []
  action:
  - service: input_number.set_value
    data:
      value: 99999
    entity_id: input_number.dide_radiator_intgegraal
  - service: input_number.set_value
    data:
      value: 600
    entity_id: input_number.dide_radiator_intgegraal
  mode: single
- id: '1602700723627'
  alias: Reset Radiator Dide
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.temperatuur_dide_ventilatie
    above: '21'
  condition:
  - condition: numeric_state
    entity_id: sensor.delft_temperature
    below: '18'
  action:
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.reset_radiator_dide
  - service: input_boolean.turn_off
    data: {}
    entity_id: input_boolean.reset_radiator_dide
  mode: single
- id: '1605727689331'
  alias: Thermostaat Kikkerkamer aan
  description: ''
  trigger:
  - platform: time
    at: '7:00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - service: climate.set_temperature
    data:
      temperature: 20
    target:
      entity_id: climate.thermostaat_kikkerkamer
  mode: single
- id: '1608068029362'
  alias: Battery Level Notification woonkamer
  description: ''
  use_blueprint:
    path: jazakrzewski/send-notification-for-battery-level.yaml
    input:
      battery_level: 25
      notify_device: e0f94f78bff548d189dd5109b894c38a
      battery_entity: sensor.woonkamer_multisensor_battery_level_2
      message: Woonkamer multisensor batterij 25%
- id: '1609087245674'
  alias: 'Deurbel: notificatie'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.doorbell_button
    to: 'on'
  - platform: state
    entity_id: input_boolean.deurbel_dummy_trigger
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.deurbel_to_phone_sander
    state: 'on'
  action:
  - service: notify.mobile_app_pocophone_f1
    data:
      title: Deurbel
      message: De deurbel gaat af
      data:
        channel: alarm_stream
        priority: high
        ledColor: red
        vibrationPattern: 100, 1000, 100, 1000, 100
  - delay: 00:00:10
  mode: single
- id: '1609134677541'
  alias: Convectorput
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /1
  condition: []
  action:
  - choose:
    - conditions:
      - condition: numeric_state
        entity_id: sensor.convector_aanvoer_temperatuur
        above: '35'
      - condition: numeric_state
        entity_id: sensor.convector_delta_sp
        above: '2'
      sequence:
      - service: light.turn_on
        data:
          brightness: 220
        entity_id: light.convectorput
    - conditions:
      - condition: numeric_state
        entity_id: sensor.convector_aanvoer_temperatuur
        above: '35'
      - condition: numeric_state
        entity_id: sensor.convector_delta_sp
        above: '1'
      sequence:
      - service: light.turn_on
        data:
          brightness: 180
        entity_id: light.convectorput
    - conditions:
      - condition: numeric_state
        entity_id: sensor.convector_aanvoer_temperatuur
        below: '35'
      sequence:
      - service: light.turn_off
        data: {}
        entity_id: light.convectorput
    default:
    - service: light.turn_on
      data:
        brightness: 165
      entity_id: light.convectorput
  mode: single
- id: '1609139820580'
  alias: 'nodered: check if online'
  description: ''
  trigger:
  - minutes: /5
    platform: time_pattern
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: counter.nodered_disconnected
        state: '2'
      sequence:
      - service: notify.telegram
        data:
          message: Node Red restart
      - service: counter.reset
        data: {}
        entity_id: counter.nodered_disconnected
      - service: rest_command.nodered_restart
        data: {}
    - conditions:
      - condition: state
        entity_id: input_boolean.nodered_alive
        for: 0:01:00
        state: 'off'
      sequence:
      - data:
          message: Node Red draait niet
        service: notify.telegram
      - service: counter.increment
        data: {}
        entity_id: counter.nodered_disconnected
    default:
    - data:
        entity_id: input_boolean.nodered_alive
      service: input_boolean.turn_off
    - service: counter.reset
      data: {}
      entity_id: counter.nodered_disconnected
  mode: single
- id: '1609149843283'
  alias: 'Deurbel: reset'
  description: ''
  trigger:
  - platform: time
    at: '18:00'
  - platform: time
    at: '22:00'
  - platform: time
    at: '6:00'
  condition: []
  action:
  - service: input_boolean.turn_off
    data: {}
    entity_id: input_boolean.deurbel_to_phone_sander
  - service: switch.turn_on
    data: {}
    entity_id: switch.doorbell_chime_active
  mode: single
- id: '1610725539887'
  alias: 'Shower: shower_on_off'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.warm_water_dhw_active
    to: 'off'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_boolean.shower2
        state: 'on'
      sequence:
      - service: input_boolean.turn_off
        data: {}
        entity_id: input_boolean.shower2
    default:
    - service: input_boolean.turn_on
      data: {}
      entity_id: input_boolean.stop_shower_fan
  mode: single
- id: '1610725766640'
  alias: 'Shower: shower_fan_delay'
  description: ''
  trigger:
  - platform: state
    entity_id: input_boolean.shower2
    to: 'off'
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 20
      seconds: 0
      milliseconds: 0
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.stop_shower_fan
  mode: restart
- id: '1610725874987'
  alias: 'Shower: reset_zolder_ventilatie_close_lock'
  description: ''
  trigger:
  - platform: state
    entity_id: input_boolean.zolder_ventilatie_close_lock
    to: 'on'
    for: 00:00:60
  condition: []
  action:
  - service: input_boolean.turn_off
    data: {}
    entity_id: input_boolean.zolder_ventilatie_close_lock
  mode: single
- id: '1610739814772'
  alias: 'Shower: shower_fan_on dhw_active'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.warm_water_dhw_active
    to: 'on'
  condition:
  - condition: state
    entity_id: light.badkamer_plafond_level
    state: 'on'
  action:
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.zolder_ventilatie_close_lock
  - service: cover.close_cover
    data: {}
    entity_id: cover.zolder_ventilatie
  - service: fan.turn_on
    data:
      speed: High
    target:
      entity_id: fan.itho
  - service: switch.turn_on
    target:
      entity_id: switch.fansendhigh
  mode: single
- id: '1610739884895'
  alias: 'Shower: shower_fan_on shower2 on'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.warm_water_dhw_active
    to: 'on'
  condition: []
  action:
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.zolder_ventilatie_close_lock
  - service: cover.close_cover
    data: {}
    entity_id: cover.zolder_ventilatie
  - service: fan.turn_on
    data:
      speed: High
    target:
      entity_id: fan.itho
  - service: switch.turn_on
    target:
      entity_id: switch.fansendhigh
  mode: single
- id: '1610740028740'
  alias: 'Shower: shower_fan_on humdelta'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.humdelta
  condition: []
  action:
  - choose:
    - conditions:
      - condition: numeric_state
        entity_id: sensor.humdelta
        above: '15'
      sequence:
      - service: fan.turn_on
        data:
          speed: high
        entity_id: fan.itho
      - service: cover.close_cover
        data: {}
        entity_id: cover.zolder_ventilatie
      - service: input_boolean.turn_on
        data: {}
        entity_id: input_boolean.zolder_ventilatie_close_lock
    - conditions:
      - condition: numeric_state
        entity_id: sensor.humdelta
        above: '10'
      - condition: state
        entity_id: input_boolean.shower2
        state: 'off'
      sequence:
      - service: fan.turn_on
        data:
          speed: medium
        entity_id: fan.itho
    - conditions:
      - condition: numeric_state
        entity_id: sensor.humdelta
        below: '10'
      - condition: state
        entity_id: input_boolean.shower2
        state: 'off'
      sequence:
      - service: fan.turn_on
        data:
          speed: low
        entity_id: fan.itho
    default: []
  mode: single
- id: '1610740504640'
  alias: 'Shower: shower_fan_off'
  description: ''
  trigger:
  - platform: state
    entity_id: input_boolean.stop_shower_fan
    to: 'on'
  condition: []
  action:
  - wait_template: '{{ is_state(''input_boolean.zolder_ventilatie_close_lock'', ''off'')
      }}'
  - service: input_boolean.turn_off
    data: {}
    entity_id: input_boolean.shower2
  - service: input_boolean.turn_off
    data: {}
    entity_id: input_boolean.stop_shower_fan
  - service: fan.turn_on
    data:
      speed: Low
    target:
      entity_id: fan.itho
  - service: cover.open_cover
    data: {}
    entity_id: cover.zolder_ventilatie
  - service: switch.turn_on
    target:
      entity_id: switch.fansendlow
  mode: single
- id: '1612606695349'
  alias: 'Shower: shower_fan_on humdelta (Duplicate)2'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.humdelta
  condition: []
  action:
  - choose:
    - conditions:
      - condition: numeric_state
        entity_id: sensor.humdelta
        above: '15'
      sequence:
      - service: fan.turn_on
        data:
          speed: High
        entity_id: fan.itho
      - service: cover.close_cover
        data: {}
        entity_id: cover.zolder_ventilatie
      - service: input_boolean.turn_on
        data: {}
        entity_id: input_boolean.zolder_ventilatie_close_lock
    default: []
  mode: single
- id: '1612611376354'
  alias: 'Shower: shower_on_off (delay)'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.warm_water_dhw_active
    to: 'on'
    for: 00:00:59
  condition:
  - condition: state
    state: 'on'
    entity_id: light.badkamer_plafond_level
  action:
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.shower2
  mode: single
- id: '1612725472934'
  alias: Reload ZWaveJS hourly
  description: ''
  trigger:
  - platform: time_pattern
    hours: /1
  condition: []
  action:
  - service: rest_command.reload_zwavejs
    data: {}
  mode: single
- id: '1613721891474'
  alias: 'Shower: shower_fan_on humdelta (Low)'
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /5
  condition:
  - condition: state
    entity_id: input_boolean.shower2
    state: 'Off'
  - condition: numeric_state
    entity_id: sensor.humdelta
    below: '10'
  action:
  - service: fan.turn_off
    data: {}
    entity_id: fan.itho
  - service: switch.turn_on
    target:
      entity_id: switch.fansendlow
  mode: single
- id: '1614104203023'
  alias: occusim aan (tijd)
  description: ''
  trigger:
  - platform: time
    at: '18:00'
  condition:
  - condition: time
    before: '22:00'
  - condition: state
    entity_id: light.wk_muur_level
    state: 'off'
  - condition: sun
    after: sunset
  action:
  - service: scene.turn_on
    data: {}
    entity_id: scene.woonkamer_low
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.occupancy_simulation
  mode: single
- id: '1614105346973'
  alias: occusim aan (sunset)
  description: ''
  trigger:
  - platform: sun
    event: sunset
  condition:
  - condition: time
    before: '22:00'
  - condition: state
    entity_id: light.wk_muur_level
    state: 'off'
  - condition: time
    after: '17:59'
  action:
  - service: scene.turn_on
    data: {}
    entity_id: scene.woonkamer_low
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.occupancy_simulation
  - service: notify.telegram
    data:
      message: 'Occusim: lichten gaan aan'
  mode: single
- id: '1614349029131'
  alias: 'Occusim: random off (test)'
  description: x
  trigger:
  - at: '22:20:00'
    platform: time
  condition: []
  action:
  - delay:
      seconds: '{{ range(10, 20)|random }}'
  - service: light.turn_off
    data: {}
    entity_id: all
  - data:
      message: 'Occusim: lichten gaan uit'
    service: notify.telegram
  - data: {}
    entity_id: input_boolean.occupancy_simulation
    service: input_boolean.turn_off
  - delay: 00:00:10
  - service: light.turn_on
    data: {}
    entity_id: light.mbr_plafond_level
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: light.turn_off
    data: {}
    entity_id: light.mbr_plafond_level
  mode: single
- id: '1614434635489'
  alias: testing 123
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /1
  condition:
  - condition: template
    value_template: '{{ now().hour < 9 }}'
  action:
  - service: notify.mobile_app_pocophone_f1
    data:
      message: kitchen light is turned {{ sun.sun }}
  mode: single
- id: '1615876916940'
  alias: Thermostaat Kikkerkamer uit
  description: ''
  trigger:
  - platform: time
    at: '17:30'
  - platform: time
    at: '22:00'
  condition: []
  action:
  - service: climate.set_temperature
    data:
      temperature: 15
    target:
      entity_id: climate.thermostaat_kikkerkamer
  mode: single
- id: '1621308728747'
  alias: 'Speakers: Raumfeld on at reboot'
  description: ''
  trigger:
  - platform: homeassistant
    event: shutdown
  condition: []
  action:
  - service: teufel_raumfeld.set_power_state
    data:
      entity_id: sensor.room_woonkamer_powerstate
      power_state: 'on'
  mode: single
- id: '1621535944945'
  alias: 'Speakers: On when starting music'
  description: ''
  trigger:
  - platform: state
    entity_id: media_player.spotify_sbalk
    attribute: source
    to: Woonkamer
  - platform: state
    entity_id: sensor.room_woonkamer_powerstate
    to: ACTIVE
  condition: []
  action:
  - service: switch.turn_on
    target:
      entity_id: switch.speakers
  mode: single
- id: '1621536577376'
  alias: 'Speakers: On when starting Spotify'
  description: ''
  trigger:
  - platform: state
    entity_id: media_player.spotify_sbalk
    to: playing
  condition:
  - condition: state
    entity_id: media_player.spotify_sbalk
    state: Woonkamer
    attribute: source
  action:
  - service: switch.turn_on
    target:
      entity_id: switch.speakers
  mode: single
- id: '1621669121811'
  alias: 'Speakers: Off after 10 minutes'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.room_woonkamer_powerstate
    to: eco
    for: 00:10:00
  condition: []
  action:
  - service: switch.turn_off
    target:
      device_id: 3aea11517a47b98f5b0734e69908866e
  mode: single
- id: '1622399126247'
  alias: Vaccinatie melder
  description: ''
  trigger:
  - platform: mqtt
    topic: coronavirus/vaccinatie
    payload: '1981'
  - platform: mqtt
    topic: coronavirus/vaccinatie
    payload: '1982'
  - platform: mqtt
    topic: coronavirus/vaccinatie
    payload: '1983'
  condition: []
  action:
  - service: notify.mobile_app_pocophone_f1
    data:
      title: Vaccinatie!
      message: Linda mag een afspraak maken!
  - service: notify.telegram
    data:
      title: Vaccinatie!
      message: Linda mag een afspraak maken!
  mode: single
- id: '1623484282780'
  alias: 'DSMR: switch running on'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.dsmr_reading_timestamp
  condition: []
  action:
  - service: input_boolean.turn_on
    target:
      entity_id: input_boolean.dsmr_running
  mode: single
- id: '1623484898099'
  alias: 'DSMR: switch running off'
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /5
  condition: []
  action:
  - service: input_boolean.turn_off
    target:
      entity_id: input_boolean.dsmr_running
  mode: single
- id: '1623484988774'
  alias: 'DSMR: warn'
  description: ''
  trigger:
  - platform: state
    entity_id: input_boolean.dsmr_running
    to: 'off'
    for: 2 minutes
  condition: []
  action:
  - service: notify.telegram
    data:
      title: DSMR
      message: DSMR not running
  mode: single
